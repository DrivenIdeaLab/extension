var _e=Object.defineProperty;var ye=(e,t,l)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var W=(e,t,l)=>(ye(e,typeof t!="symbol"?t+"":t,l),l);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function l(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=l(o);fetch(o.href,r)}})();function $(){}function ie(e){return e()}function Y(){return Object.create(null)}function A(e){e.forEach(ie)}function de(e){return typeof e=="function"}function ce(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ve(e){return Object.keys(e).length===0}function w(e,t){e.appendChild(t)}function L(e,t,l){e.insertBefore(t,l||null)}function j(e){e.parentNode&&e.parentNode.removeChild(e)}function be(e,t){for(let l=0;l<e.length;l+=1)e[l]&&e[l].d(t)}function m(e){return document.createElement(e)}function J(e){return document.createTextNode(e)}function C(){return J(" ")}function ke(){return J("")}function S(e,t,l,n){return e.addEventListener(t,l,n),()=>e.removeEventListener(t,l,n)}function u(e,t,l){l==null?e.removeAttribute(t):e.getAttribute(t)!==l&&e.setAttribute(t,l)}function xe(e){return Array.from(e.childNodes)}function Se(e,t){t=""+t,e.data!==t&&(e.data=t)}function M(e,t){e.value=t??""}function Q(e,t,l){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t){o.selected=!0;return}}(!l||t!==void 0)&&(e.selectedIndex=-1)}function Ce(e){const t=e.querySelector(":checked");return t&&t.__value}let N;function B(e){N=e}function Ee(){if(!N)throw new Error("Function called outside component initialization");return N}function Me(e){Ee().$$.on_mount.push(e)}const T=[],X=[];let I=[];const ee=[],je=Promise.resolve();let F=!1;function Le(){F||(F=!0,je.then(ue))}function D(e){I.push(e)}const Z=new Set;let O=0;function ue(){if(O!==0)return;const e=N;do{try{for(;O<T.length;){const t=T[O];O++,B(t),Oe(t.$$)}}catch(t){throw T.length=0,O=0,t}for(B(null),T.length=0,O=0;X.length;)X.pop()();for(let t=0;t<I.length;t+=1){const l=I[t];Z.has(l)||(Z.add(l),l())}I.length=0}while(T.length);for(;ee.length;)ee.pop()();F=!1,Z.clear(),B(e)}function Oe(e){if(e.fragment!==null){e.update(),A(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}function Te(e){const t=[],l=[];I.forEach(n=>e.indexOf(n)===-1?t.push(n):l.push(n)),l.forEach(n=>n()),I=t}const q=new Set;let Ie;function ae(e,t){e&&e.i&&(q.delete(e),e.i(t))}function $e(e,t,l,n){if(e&&e.o){if(q.has(e))return;q.add(e),Ie.c.push(()=>{q.delete(e)}),e.o(t)}}function te(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ae(e){e&&e.c()}function fe(e,t,l){const{fragment:n,after_update:o}=e.$$;n&&n.m(t,l),D(()=>{const r=e.$$.on_mount.map(ie).filter(de);e.$$.on_destroy?e.$$.on_destroy.push(...r):A(r),e.$$.on_mount=[]}),o.forEach(D)}function we(e,t){const l=e.$$;l.fragment!==null&&(Te(l.after_update),A(l.on_destroy),l.fragment&&l.fragment.d(t),l.on_destroy=l.fragment=null,l.ctx=[])}function Be(e,t){e.$$.dirty[0]===-1&&(T.push(e),Le(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function pe(e,t,l,n,o,r,i=null,s=[-1]){const p=N;B(e);const d=e.$$={fragment:null,ctx:[],props:r,update:$,not_equal:o,bound:Y(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(p?p.$$.context:[])),callbacks:Y(),dirty:s,skip_bound:!1,root:t.target||p.$$.root};i&&i(d.root);let h=!1;if(d.ctx=l?l(e,t.props||{},(a,c,...y)=>{const f=y.length?y[0]:c;return d.ctx&&o(d.ctx[a],d.ctx[a]=f)&&(!d.skip_bound&&d.bound[a]&&d.bound[a](f),h&&Be(e,a)),c}):[],d.update(),h=!0,A(d.before_update),d.fragment=n?n(d.ctx):!1,t.target){if(t.hydrate){const a=xe(t.target);d.fragment&&d.fragment.l(a),a.forEach(j)}else d.fragment&&d.fragment.c();t.intro&&ae(e.$$.fragment),fe(e,t.target,t.anchor),ue()}B(p)}class me{constructor(){W(this,"$$");W(this,"$$set")}$destroy(){we(this,1),this.$destroy=$}$on(t,l){if(!de(l))return $;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(l),()=>{const o=n.indexOf(l);o!==-1&&n.splice(o,1)}}$set(t){this.$$set&&!ve(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ne="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ne);const le=async(e,t)=>{let l=null;const n=await fetch(`${t}/api/models`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...e&&{authorization:`Bearer ${e}`}}}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(console.log(r),l=r,null));if(l)throw l;let o=(n==null?void 0:n.data)??[];return o=o.filter(r=>r).sort((r,i)=>{const s=r.name.toLowerCase(),p=i.name.toLowerCase();return s<p?-1:s>p?1:r<i?-1:r>i?1:0}),console.log(o),o},He=async(e="",t={},l="http://localhost:8080")=>{const n=new AbortController;let o=null;const r=await fetch(`${l}/chat/completions`,{signal:n.signal,method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(i=>(console.log(i),o=i,null));if(o)throw o;return[r,n]},ze=e=>{let t="";return new TransformStream({transform(l,n){t+=l;const o=t.split(e);o.slice(0,-1).forEach(r=>n.enqueue(r)),t=o[o.length-1]},flush(l){t&&l.enqueue(t)}})};function ne(e,t,l){const n=e.slice();return n[6]=t[l],n}function oe(e){let t,l,n;function o(s,p){return s[1]?Pe:Ke}let r=o(e),i=r(e);return{c(){t=m("div"),i.c(),u(t,"class","tlwd-fixed tlwd-top-0 tlwd-right-0 tlwd-left-0 tlwd-bottom-0 tlwd-w-full tlwd-min-h-screen tlwd-h-screen tlwd-flex tlwd-justify-center tlwd-z-[9999999999] tlwd-overflow-hidden tlwd-overscroll-contain")},m(s,p){L(s,t,p),i.m(t,null),l||(n=S(t,"mousedown",e[15]),l=!0)},p(s,p){r===(r=o(s))&&i?i.p(s,p):(i.d(1),i=r(s),i&&(i.c(),i.m(t,null)))},d(s){s&&j(t),i.d(),l=!1,n()}}}function Ke(e){let t,l,n,o,r,i,s,p,d,h,a,c,y,f;return{c(){t=m("div"),l=m("div"),n=m("form"),o=m("div"),r=m("div"),r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"></path></svg>`,i=C(),s=m("input"),p=C(),d=m("div"),h=m("div"),h.textContent="Press âŒ˜Space+Shift to toggle",a=C(),c=m("button"),c.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-3"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path></svg>`,u(r,"class","tlwd-flex tlwd-items-center"),u(s,"id","open-webui-search-input"),u(s,"placeholder","Search Open WebUI"),u(s,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(s,"autocomplete","one-time-code"),u(o,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),u(h,"class","tlwd-text-right tlwd-text-[0.7rem] tlwd-p-0 tlwd-m-0 tlwd-text-neutral-300 tlwd-h-fit"),u(c,"class","tlwd-h-fit tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(c,"type","button"),u(d,"class","tlwd-flex tlwd-justify-end tlwd-gap-1 tlwd-items-center"),u(n,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),u(n,"autocomplete","off"),u(l,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),u(t,"class","tlwd-m-auto tlwd-max-w-xl tlwd-w-full tlwd-pb-32")},m(k,E){L(k,t,E),w(t,l),w(l,n),w(n,o),w(o,r),w(o,i),w(o,s),M(s,e[4]),w(n,p),w(n,d),w(d,h),w(d,a),w(d,c),y||(f=[S(s,"input",e[13]),S(c,"click",e[14]),S(n,"submit",e[7]),S(n,"mousedown",Ue)],y=!0)},p(k,E){E&16&&s.value!==k[4]&&M(s,k[4])},d(k){k&&j(t),y=!1,A(f)}}}function Pe(e){let t,l,n,o,r,i,s,p,d,h,a,c,y,f,k,E,H,b=e[5]&&e[5].length>0&&re(e);return{c(){t=m("div"),l=m("div"),n=m("form"),o=m("div"),r=m("div"),r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"></path></svg>`,i=C(),s=m("input"),p=C(),d=m("div"),h=m("div"),h.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"></path></svg>`,a=C(),c=m("input"),y=C(),f=m("button"),f.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"></path></svg>`,k=C(),b&&b.c(),u(r,"class","tlwd-flex tlwd-items-center"),u(s,"id","open-webui-url-input"),u(s,"placeholder","Open WebUI URL"),u(s,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(s,"autocomplete","one-time-code"),s.required=!0,u(o,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full"),u(h,"class","tlwd-flex tlwd-items-center"),u(c,"placeholder","Open WebUI API Key"),u(c,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(c,"autocomplete","one-time-code"),c.required=!0,u(f,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(f,"type","button"),u(d,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2"),u(n,"class","tlwd-text-gray-200 tlwd-w-full tlwd-p-0 tlwd-m-0"),u(n,"autocomplete","off"),u(l,"class","tlwd-w-full tlwd-flex tlwd-flex-col tlwd-justify-between tlwd-py-2.5 tlwd-px-3.5 tlwd-rounded-2xl tlwd-outline tlwd-outline-1 tlwd-outline-gray-850 tlwd-backdrop-blur-3xl tlwd-bg-gray-850/70 shadow-4xl modal-animation"),u(t,"class","tlwd-m-auto tlwd-max-w-sm tlwd-w-full tlwd-pb-32")},m(x,g){L(x,t,g),w(t,l),w(l,n),w(n,o),w(o,r),w(o,i),w(o,s),M(s,e[2]),w(n,p),w(n,d),w(d,h),w(d,a),w(d,c),M(c,e[3]),w(d,y),w(d,f),w(n,k),b&&b.m(n,null),E||(H=[S(s,"input",e[9]),S(c,"input",e[10]),S(f,"click",e[11]),S(n,"submit",e[8]),S(n,"mousedown",De)],E=!0)},p(x,g){g&4&&s.value!==x[2]&&M(s,x[2]),g&8&&c.value!==x[3]&&M(c,x[3]),x[5]&&x[5].length>0?b?b.p(x,g):(b=re(x),b.c(),b.m(n,null)):b&&(b.d(1),b=null)},d(x){x&&j(t),b&&b.d(),E=!1,A(H)}}}function re(e){let t,l,n,o,r,i,s,p,d,h=te(e[5]),a=[];for(let c=0;c<h.length;c+=1)a[c]=se(ne(e,h,c));return{c(){t=m("div"),l=m("div"),l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"></path></svg>`,n=C(),o=m("select"),r=m("option"),r.textContent="Select a model";for(let c=0;c<a.length;c+=1)a[c].c();i=C(),s=m("button"),s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="${2.5}" stroke="currentColor" class="tlwd-size-5"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"></path></svg>`,u(l,"class","tlwd-flex tlwd-items-center"),r.__value="",M(r,r.__value),u(o,"id","open-webui-model-input"),u(o,"class","tlwd-p-0 tlwd-m-0 tlwd-text-xl tlwd-w-full tlwd-font-medium tlwd-bg-transparent tlwd-border-none placeholder:tlwd-text-gray-500 tlwd-text-neutral-100 tlwd-outline-none"),u(o,"autocomplete","off"),o.required=!0,e[6]===void 0&&D(()=>e[12].call(o)),u(s,"class","tlwd-flex tlwd-items-center tlwd-bg-transparent tlwd-text-neutral-100 tlwd-cursor-pointer tlwd-p-0 tlwd-m-0 tlwd-outline-none tlwd-border-none"),u(s,"type","submit"),u(t,"class","tlwd-flex tlwd-items-center tlwd-gap-2 tlwd-w-full tlwd-mt-2")},m(c,y){L(c,t,y),w(t,l),w(t,n),w(t,o),w(o,r);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(o,null);Q(o,e[6],!0),w(t,i),w(t,s),p||(d=S(o,"change",e[12]),p=!0)},p(c,y){if(y&32){h=te(c[5]);let f;for(f=0;f<h.length;f+=1){const k=ne(c,h,f);a[f]?a[f].p(k,y):(a[f]=se(k),a[f].c(),a[f].m(o,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=h.length}y&96&&Q(o,c[6])},d(c){c&&j(t),be(a,c),p=!1,d()}}}function se(e){let t,l=(e[6].name??e[6].id)+"",n,o;return{c(){t=m("option"),n=J(l),t.__value=o=e[6].id,M(t,t.__value)},m(r,i){L(r,t,i),w(t,n)},p(r,i){i&32&&l!==(l=(r[6].name??r[6].id)+"")&&Se(n,l),i&32&&o!==(o=r[6].id)&&(t.__value=o,M(t,t.__value))},d(r){r&&j(t)}}}function qe(e){let t,l=e[0]&&oe(e);return{c(){l&&l.c(),t=ke()},m(n,o){l&&l.m(n,o),L(n,t,o)},p(n,[o]){n[0]?l?l.p(n,o):(l=oe(n),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},i:$,o:$,d(n){n&&j(t),l&&l.d(n)}}}const De=e=>{e.stopPropagation()},Ue=e=>{e.stopPropagation()};function Ve(e,t,l){let n=!1,o=!0,r="",i="",s="",p="",d=[];const h=()=>{console.log("resetConfig");try{chrome.storage.local.clear().then(()=>{console.log("Value is cleared")})}catch(g){console.log(g),localStorage.setItem("url",""),localStorage.setItem("key",""),localStorage.setItem("model","")}l(2,r=""),l(3,i=""),l(6,s=""),l(5,d=[]),l(1,o=!0)},a=g=>{g.preventDefault(),window.open(`${r}/?q=${encodeURIComponent(p)}&models=${s}`,"_blank"),l(4,p=""),l(0,n=!1)},c=g=>{g.preventDefault();try{chrome.storage.local.set({url:r,key:i,model:s}).then(()=>{console.log("Value is set")})}catch(z){console.log(z),localStorage.setItem("url",r),localStorage.setItem("key",i),localStorage.setItem("model",s)}l(1,o=!1)};Me(async()=>{let g=null;try{g=await chrome.storage.local.get()}catch(_){console.log(_)}g&&(l(2,r=g.url??""),l(3,i=g.key??""),l(6,s=g.model??""),g.url&&g.key&&g.model&&(l(5,d=await le(g.key,g.url).catch(_=>{console.log(_),h()})),d&&l(1,o=!1)));const z=async _=>{var G;if(n&&_.shiftKey&&_.key==="Escape"?h():_.key==="Escape"&&l(0,n=!1),_.key===" "&&(_.metaKey||_.ctrlKey)&&(_.shiftKey||_.altKey)){_.preventDefault();try{const v=await chrome.runtime.sendMessage({action:"getSelection"});((v==null?void 0:v.data)??!1)&&l(4,p=v.data)}catch(v){console.log("catch",v)}l(0,n=!n),setTimeout(()=>{const v=document.getElementById("open-webui-search-input");v&&v.focus()},0)}if(i!==""&&r!==""&&_.key==="Enter"&&(_.metaKey||_.ctrlKey)&&(_.shiftKey||_.altKey)){_.preventDefault();try{const v=await chrome.runtime.sendMessage({action:"getSelection"});if((v==null?void 0:v.data)??!1){await chrome.runtime.sendMessage({action:"writeText",text:`
`});const[U,Fe]=await He(i,{model:s,messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:v.data}],stream:!0},((G=d.find(V=>V.id===s))==null?void 0:G.owned_by)==="openai"?`${r}/openai`:`${r}/ollama/v1`);if(U&&U.ok){const V=U.body.pipeThrough(new TextDecoderStream).pipeThrough(ze(`
`)).getReader();for(;;){const{value:he,done:ge}=await V.read();if(ge)break;try{let R=he.split(`
`);for(const K of R)if(K!=="")if(console.log(K),K==="data: [DONE]")console.log("DONE");else{let P=JSON.parse(K.replace(/^data: /,""));console.log(P),"request_id"in P?console.log(P.request_id):await chrome.runtime.sendMessage({action:"writeText",text:P.choices[0].delta.content??""})}}catch(R){console.log(R)}}}}}catch(v){console.log(v)}}};return document.addEventListener("keydown",z,{capture:!0}),()=>document.removeEventListener("keydown",z)});function y(){r=this.value,l(2,r)}function f(){i=this.value,l(3,i)}const k=async()=>{r.endsWith("/")&&l(2,r=r.slice(0,-1)),l(5,d=await le(i,r))};function E(){s=Ce(this),l(6,s),l(5,d)}function H(){p=this.value,l(4,p)}return[n,o,r,i,p,d,s,a,c,y,f,k,E,H,()=>{l(1,o=!0)},()=>{l(0,n=!1)}]}class Re extends me{constructor(t){super(),pe(this,t,Ve,qe,ce,{})}}function We(e){let t,l,n;return l=new Re({}),{c(){t=m("div"),Ae(l.$$.fragment),u(t,"class","extension-container")},m(o,r){L(o,t,r),fe(l,t,null),n=!0},p:$,i(o){n||(ae(l.$$.fragment,o),n=!0)},o(o){$e(l.$$.fragment,o),n=!1},d(o){o&&j(t),we(l)}}}class Ze extends me{constructor(t){super(),pe(this,t,null,We,ce,{})}}new Ze({target:document.getElementById("extension-app")});
